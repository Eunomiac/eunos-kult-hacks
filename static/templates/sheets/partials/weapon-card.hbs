<div class="weapon-card move-card">
  {{#let
    anchorName=(getUniqueID "move-card-anchor")
    popoverID=(getUniqueID "move-card-popover")
  }}
  <span class="is-equipped-container">
    <a class="item-toggle-equipped" data-item-id="{{_id}}" title="{{#if system.isEquipped}}Equipped{{else}}Not Equipped{{/if}}">
      <i class="{{#if system.isEquipped}}fas fa-hand-rock{{else}}far fa-hand{{/if}}"></i>
    </a>
  </span>
  <div class="move-info {{type}}-info item-name" data-item-id="{{_id}}" popovertarget="{{popoverID}}" style="anchor-name: --{{anchorName}}">
    <a class="move-roll">{{name}} </a>
    {{#if (eq system.class "Firearm")}}
      {{{getAmmoDisplay system.ammo.value system.ammo.max}}}
    {{/if}}
  </div>

  <div id="{{popoverID}}"
    class="weapon-tooltip"
    style="position-anchor: --{{anchorName}};"
    popover>
    <h1>{{name}}</h1>
    <h2>{{system.class}} <em>({{system.subClass}})</em></h2>
    <span class="flex-row">
        <label>Range:</label><span>{{system.range}}</span>
      {{#if (eq system.class "Firearm")}}
          <label>Ammo:</label><span>{{system.ammo.value}}/{{system.ammo.max}}</span>
      {{/if}}
    </span>
  </div>

    <div class="item-controls" data-item-id="{{_id}}">
      <a class="item-control item-show" title="{{localize 'k4lt.ShowItem'}}"><i class="far fa-comment-alt"></i></a>
      <a class="item-control item-edit" title="{{localize 'k4lt.EditItem'}}"><i class="fas fa-eye"></i></a>
      <a class="item-control item-delete" title="{{localize 'k4lt.DeleteItem'}}"><i class="fas fa-trash"></i></a>
    </div>
  {{/let}}
</div>
{{#if system.isEquipped}}
{{#each system.attacks as |attack i|}}
<div class="weapon-attack-block" data-item-id="{{../_id}}" data-attack-index="{{i}}">
  <div class="attack-top-row">
    <div class="attack-harm">{{attack.harm}}</div>
    <div class="attack-name">{{attack.name}}</div>
    {{#if (eq ../system.class "Firearm")}}
      {{{getAmmoDisplay attack.ammoCost attack.ammoCost}}}
    {{/if}}
  </div>
  {{#unless (eq attack.special "")}}
  <div class="attack-bottom-row">
    <div class="attack-special"><span class="down-arrow">â†³</span> <em>{{attack.special}}</em></div>
  </div>
  {{/unless}}
</div>
{{/each}}
{{/if}}
